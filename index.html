<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" /> <!-- 1 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <!-- 2 -->
    <title>ç‰©ä»¶ãƒãƒƒãƒ—</title> <!-- 3 -->
    <link rel="icon" href="./logo_512x512.png" /> <!-- 4 -->
    <link rel="manifest" href="./manifest.json" /> <!-- 5 -->
    <meta name="theme-color" content="#ffffff" /> <!-- 6 -->
    <style> <!-- 7 -->
      body { margin: 0; font-family: sans-serif; } <!-- 8 -->
      #login-box { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; } <!-- 9 -->
      #map, .filter-box, .city-filter-box { display: none; } <!-- 10 -->
      #map { height: calc(100vh - 140px); width: 100%; } <!-- 11 -->
      .info-window { font-size: 12px; line-height: 1.4; max-width: 240px; padding: 8px; border: 1px solid #ccc; border-radius: 8px; } <!-- 12 -->
      .info-window .info-title { font-size: 14px; font-weight: bold; margin-bottom: 2px; } <!-- 13 -->
      .info-window .info-category { font-size: 11px; color: #666; margin-bottom: 6px; } <!-- 14 -->
      .info-window .info-link { display: inline-block; margin: 4px 0; color: #1a73e8; text-decoration: none; font-weight: bold; font-size: 12px; } <!-- 15 -->
      .info-window .info-line { margin: 2px 0; font-size: 12px; } <!-- 16 -->
      .info-window .info-line span { font-weight: normal; } <!-- 17 -->
      select { font-size: 1.4rem; padding: 6px; width: 100%; max-width: 300px; } <!-- 18 -->
      label { font-size: 1.4rem; display: block; margin-bottom: 5px; } <!-- 19 -->
    </style> <!-- 20 -->
  </head>

  <body> <!-- 21 -->
    <div id="login-box"> <!-- 22 -->
      <h2>ãƒ‘ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</h2> <!-- 23 -->
      <input type="password" id="passcode-input" placeholder="ãƒ‘ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›" /> <!-- 24 -->
      <button onclick="checkPasscode()">ãƒ­ã‚°ã‚¤ãƒ³</button> <!-- 25 -->
      <p id="error-message" style="color: red;"></p> <!-- 26 -->
    </div> <!-- 27 -->

    <div class="filter-box" style="padding:10px;background:#f5f5f5"> <!-- 28 -->
      <label for="filter">ã‚«ãƒ†ã‚´ãƒªã§çµã‚Šè¾¼ã¿ï¼š</label> <!-- 29 -->
      <select id="filter" onchange="filterMarkers()"> <!-- 30 -->
        <option value="">é¸æŠ</option> <!-- 31 -->
        <option value="åœŸåœ°">åœŸåœ°</option> <!-- 32 -->
        <option value="æˆ¸å»ºã¦">æˆ¸å»ºã¦</option> <!-- 33 -->
        <option value="ãƒãƒ³ã‚·ãƒ§ãƒ³">ãƒãƒ³ã‚·ãƒ§ãƒ³</option> <!-- 34 -->
        <option value="åç›Šç‰©ä»¶">åç›Šç‰©ä»¶</option> <!-- 35 -->
        <option value="è»ç”¨åœ°">è»ç”¨åœ°</option> <!-- 36 -->
        <option value="å·¥å ´ãƒ»åº—èˆ—">å·¥å ´ãƒ»åº—èˆ—</option> <!-- 37 -->
        <option value="çœŒå¤–ãƒ»é›¢å³¶">çœŒå¤–ãƒ»é›¢å³¶</option> <!-- 38 -->
        <option value="ååˆº">ååˆº</option> <!-- 39 -->
      </select> <!-- 40 -->
    </div> <!-- 41 -->

    <div class="city-filter-box" style="padding:10px;background:#f0f0f0"> <!-- 42 -->
      <label for="cityFilter">å¸‚åŒºç”ºæ‘ã§çµã‚Šè¾¼ã¿ï¼š</label> <!-- 43 -->
      <select id="cityFilter" onchange="filterMarkers()"> <!-- 44 -->
        <option value="">é¸æŠ</option> <!-- 45 -->
      </select> <!-- 46 -->
    </div> <!-- 47 -->

    <div id="map"></div> <!-- 48 -->

    <script> <!-- 49 -->
      const CORRECT_PASSCODE = "Tkkikaku1212!"; <!-- 50 -->

      function checkPasscode() { <!-- 51 -->
        const input = document.getElementById("passcode-input").value; <!-- 52 -->
        const error = document.getElementById("error-message"); <!-- 53 -->
        if (input === CORRECT_PASSCODE) { <!-- 54 -->
          localStorage.setItem("tk_passcode", input); <!-- 55 -->
          document.getElementById("login-box").style.display = "none"; <!-- 56 -->
          document.getElementById("map").style.display = "block"; <!-- 57 -->
          document.querySelector(".filter-box").style.display = "block"; <!-- 58 -->
          document.querySelector(".city-filter-box").style.display = "block"; <!-- 59 -->
          initMap(); <!-- 60 -->
        } else { <!-- 61 -->
          error.textContent = "ãƒ‘ã‚¹ã‚³ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™"; <!-- 62 -->
        } <!-- 63 -->
      } <!-- 64 -->

      window.onload = () => { <!-- 65 -->
        const saved = localStorage.getItem("tk_passcode"); <!-- 66 -->
        if (saved === CORRECT_PASSCODE) { <!-- 67 -->
          document.getElementById("login-box").style.display = "none"; <!-- 68 -->
          document.getElementById("map").style.display = "block"; <!-- 69 -->
          document.querySelector(".filter-box").style.display = "block"; <!-- 70 -->
          document.querySelector(".city-filter-box").style.display = "block"; <!-- 71 -->
          initMap(); <!-- 72 -->
        } <!-- 73 -->
      }; <!-- 74 -->

      let map; <!-- 75 -->
      let allMarkers = []; <!-- 76 -->

      function initMap() { <!-- 77 -->
        const script = document.createElement("script"); <!-- 78 -->
        script.src = "https://script.google.com/macros/s/AKfycbyj9JRN6Wuyzwq92QUeULCcKM9yNwQClzlpnWuYX5MQbwfxbWcUsrzLZik6W9ldgPm5IA/exec?callback=displayMarkers"; <!-- 79 -->
        document.body.appendChild(script); <!-- 80 -->
      } <!-- 81 -->

      function displayMarkers(locations) { <!-- 82 -->
        map = new google.maps.Map(document.getElementById("map"), { <!-- 83 -->
          center: { lat: 26.2124, lng: 127.6809 }, <!-- 84 -->
          zoom: 10, <!-- 85 -->
        }); <!-- 86 -->

        const cityOrder = ["åè­·å¸‚", "æ©ç´æ‘", "é‡‘æ­¦ç”º", "å®œé‡åº§æ‘", "æœ¬éƒ¨ç”º", "ä»Šå¸°ä»æ‘", "å¤§å®œå‘³æ‘", "å›½é ­æ‘", "æ±æ‘", "æ²–ç¸„å¸‚", "ã†ã‚‹ã¾å¸‚", "æµ¦æ·»å¸‚", "å®œé‡æ¹¾å¸‚", "èª­è°·æ‘", "å˜‰æ‰‹ç´ç”º", "åŒ—è°·ç”º", "ä¸­åŸæ‘", "è¥¿åŸç”º", "é‚£è¦‡å¸‚", "è±Šè¦‹åŸå¸‚", "ç³¸æº€å¸‚", "å—é¢¨åŸç”º", "ä¸é‚£åŸç”º", "å…«é‡ç€¬ç”º", "çŸ³å£å¸‚", "å®®å¤å³¶å¸‚", "ãã®ä»–"]; <!-- 87 -->

        const citySet = new Set(); <!-- 88 -->
        const infoWindow = new google.maps.InfoWindow(); <!-- 89 -->
        allMarkers = []; <!-- 90 -->

        locations.forEach(loc => { <!-- 91 -->
          const iconUrl = "http://maps.google.com/mapfiles/ms/icons/" + <!-- 92 -->
            (loc.sheet === "ååˆº" ? "orange" : loc.sheet === "åœŸåœ°" ? "red" : loc.sheet === "æˆ¸å»ºã¦" ? "blue" : loc.sheet === "ãƒãƒ³ã‚·ãƒ§ãƒ³" ? "green" : loc.sheet === "åç›Šç‰©ä»¶" ? "yellow" : loc.sheet === "è»ç”¨åœ°" ? "purple" : loc.sheet === "å·¥å ´ãƒ»åº—èˆ—" ? "pink" : loc.sheet === "çœŒå¤–ãƒ»é›¢å³¶" ? "brown" : "orange") + "-dot.png"; <!-- 93 -->

          const marker = new google.maps.Marker({ <!-- 94 -->
            position: { lat: loc.lat, lng: loc.lng }, <!-- 95 -->
            map: null, <!-- 96 -->
            title: loc.name, <!-- 97 -->
            icon: { url: iconUrl, scaledSize: new google.maps.Size(60, 60) } <!-- 98 -->
          }); <!-- 99 -->

          let content = ""; <!-- 100 -->

          if (loc.sheet === "ååˆº") { <!-- 101 -->
            content = `<div class="info-window"> <!-- 102 -->
              <div class="info-title">${loc.name || ""}</div> <!-- 103 -->
              <div class="info-line">ğŸ‘¨â€ğŸ’¼ ä¼šç¤¾åï¼š<span>${loc.name || ""}</span></div> <!-- 104 -->
              <div class="info-line">ğŸ¢ ä¼šç¤¾ç•ªå·ï¼š<span>${loc.companyNumber || ""}</span></div> <!-- 105 -->
              <div class="info-line">ğŸ§‘ æ‹…å½“åï¼š<span>${loc.person || ""}</span></div> <!-- 106 -->
              <div class="info-line">ğŸ“› ãƒ•ãƒªã‚¬ãƒŠï¼š<span>${loc.furigana || ""}</span></div> <!-- 107 -->
              <div class="info-line">ğŸ“ æ‹…å½“ç•ªå·ï¼š<a href="tel:${loc.phone}">${loc.phone}</a></div> <!-- 108 -->
              <div class="info-line">ğŸ“ å‚™è€ƒï¼š<span>${loc.note || ""}</span></div> <!-- 109 -->
              <a class="info-link" href="${loc.image}" target="_blank">ğŸ“„ ååˆºPDFã‚’é–‹ã</a> <!-- 110 -->
            </div>`; <!-- 111 -->
          } else { <!-- 112 -->
            content = `<div class="info-window"> <!-- 113 -->
              <div class="info-title">${loc.name}</div> <!-- 114 -->
              <div class="info-category">${loc.sheet}</div> <!-- 115 -->
              <a class="info-link" href="${loc.pdf}" target="_blank">ğŸ“„ æ¦‚è¦æ›¸</a> <!-- 116 -->
              <div class="info-line">ğŸ’° ä¾¡æ ¼ï¼š<span>${loc.price} ä¸‡å††</span></div> <!-- 117 -->
              <div class="info-line">ğŸ“ åªå˜ä¾¡ï¼š<span>${loc.tsubo} ä¸‡å††</span></div> <!-- 118 -->
              <div class="info-line">ğŸ‘¤ ç´¹ä»‹å…ƒï¼š<span>${loc.agency}</span></div> <!-- 119 -->
              <div class="info-line">ğŸ“ å‚™è€ƒï¼š<span>${loc.note || ""}</span></div> <!-- 120 -->
            </div>`; <!-- 121 -->
            if (loc.city) citySet.add(loc.city); <!-- 122 -->
          } <!-- 123 -->

          marker.addListener("click", () => { <!-- 124 -->
            infoWindow.setContent(content); <!-- 125 -->
            infoWindow.open(map, marker); <!-- 126 -->
          }); <!-- 127 -->

          allMarkers.push({ marker, sheet: loc.sheet, city: loc.city || "" }); <!-- 128 -->
        }); <!-- 129 -->

        const citySelect = document.getElementById("cityFilter"); <!-- 130 -->
        citySelect.innerHTML = '<option value="">é¸æŠ</option>'; <!-- 131 -->
        cityOrder.forEach(city => { <!-- 132 -->
          if (citySet.has(city)) { <!-- 133 -->
            const option = document.createElement("option"); <!-- 134 -->
            option.value = city; <!-- 135 -->
            option.textContent = city; <!-- 136 -->
            citySelect.appendChild(option); <!-- 137 -->
          } <!-- 138 -->
        }); <!-- 139 -->
      } <!-- 140 -->

      function filterMarkers() { <!-- 141 -->
        const selectedCategory = document.getElementById("filter").value; <!-- 142 -->
        const selectedCity = document.getElementById("cityFilter").value; <!-- 143 -->

        allMarkers.forEach(({ marker, sheet, city }) => { <!-- 144 -->
          if (!selectedCategory) { marker.setMap(null); return; } <!-- 145 -->
          const matchCategory = selectedCategory && sheet === selectedCategory; <!-- 146 -->
          const matchCity = !selectedCity || city === selectedCity; <!-- 147 -->
          marker.setMap(matchCategory && matchCity ? map : null); <!-- 148 -->
        }); <!-- 149 -->
      } <!-- 150 -->
    </script>

    <script async defer <!-- 151 -->
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDA_HvHFLoJO8Iib-ig100cnmP2XKE124E&callback=initMap"> <!-- 152 -->
    </script> <!-- 153 -->
  </body>
</html>
